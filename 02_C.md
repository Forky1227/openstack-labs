#### 3. Adding Users with Horizon

Acme Inc wanted two users to be available to admin their systems, Alice Anderson and Bob Barker, so lets add them now that we have the project space created.

0. Log in to Horizon as admin. On the left hand side of the OpenStack Horizon GUI, **click on Identity > Users**

0. In the upper right hand corner, **click the '+Create User' button.**
  
    ![create user](https://i.imgur.com/dqbKcYW.png)

0. **Fill out the 'Create User'** screen as follows and **click Create User**

    > White spaces and capitals may be used, but they make the login more complex, so please don't use them. 

    ```
    User Name: aliceanderson     
    Description: An employee of Acme Inc.
    Email: alice@example.com
    Password: fa5tpa55w0rd
    Confirm Password: fa5tpa55w0rd
    Primary Project: acme_inc
    Role: user
    [X] Enabled
    ```

    ![user details](https://i.imgur.com/f7WtAkh.png)

0. **Create a second user,** this will be the Bob Barker profile.  

    **Fill out the second 'Create User'** screen and **click Create User**

    ```
    User Name: bobbarker     
    Description: An employee of Acme Inc.
    Email: bob@example.com
    Password: fa5tpa55w0rd
    Confirm Password: fa5tpa55w0rd
    Primary Project: acme_inc
    Role: user
    [X] Enabled
    ```


0. Log out the admin account within the Horizon GUI by clicking in the upper right hand corner, and **click 'Sign Out'**.

    ![sign out](https://i.imgur.com/JXvKgp3.png)

0. Log in as `default:aliceanderson:fa5tpa55w0rd`

7. **Click on Project > Compute > Overview**

    > This screen should look quite a bit different than the overview screen you saw when you were logged in as admin. Notice that Alice Anderson may only create a total of 2 instances, and utilize a total of 2 VCPUs. These settings reflect what was provisioned in the Project's Quota tab.
    > 
    > If you forget what the admin quota screen looked like, sign out, and sign back in as admin. It is important that you understand that Alice Anderson is a user within a project (tenant), therefore she may only utilize the resources that have been made permissible to the project for which she belongs (acme_inc).
    > 
    > Make sure you clearly understand this partitioning of available system resources into projects (tenants) via quotas before continuing the lab. We're not racing here. Take all the time you need.

#### 4. Launching Instances as a User (not admin)

0. Double check that you are signed in as `default:aliceanderson:fa5tpa55w0rd` 

    > Notice that the project in the upper left change has changed. You should be signed in as the user aliceanderson, within the default domain, and the project acme_inc.

0. **Click on Project > Compute > Instances**
0. In the upper right corner, **click 'Launch Instance'** 

    ![launch instance](https://i.imgur.com/VbUQCtI.png)

0. The Launch Instance dialog box will pop up. Fill out each tab as follows:

 **Details Tab**
    ```
    Instance Name: acme_vm1
    Availability Zone: nova
    Count: 1
    ```
    
 **Source**
    ```
    Select Boot Source: Image (from drop down menu)
    Create New Volume: No
    Allocated: cirros (selected by pressing the + button)
    ```
    
 **Flavor**
    ```
    Allocated: m1.xlarge (selected by pressing the + button)
    ```

 **Networks**
    ```
    Allocated: fabric (selected by pressing the + button)
    ```
    
 **Network Ports**
    ```
    (No changes)
    ```
    
 **Security Groups**
    ```
    (No changes)
    ```
    
 **Key Pair**
    ```
    (No changes)
    ```
    
 **Configuration**
    ```
    (No changes)
    ```
    
 **Metadata**
    ```
    (No changes)
    ```
    
0. **Click 'Launch'**, and the instance will **fail**. 

    > That's OK, just driving home the point that the project acme_inc does not have enough resources provisioned by their quota to boot the m1.xlarge flavor (the flavor is the amount of resources devoted to a VM). The problem is that the m1.xlarge flavor wants to run 8 VCPUs, and we only have 2 available to our project.

0. Let's try again, this time, configure the instance with a samller flavor so it boots:

 **Details Tab**
    ```
    Instance Name: acme_vm1
    Availability Zone: nova
    Count: 1
    ```
    
 **Source**
    ```
    Select Boot Source: Image (from drop down menu)
    Create New Volume: No
    Allocated: cirros (selected by pressing the + button)
    ```
    
 **Flavor**
    ```
    Allocated: m1.tiny (selected by pressing the + button)
    ```
    
 **Networks**
    ```
    Allocated: fabric
    ```
    
 **Network Ports**
    ```
    (No changes)
    ```
    
 **Security Groups**
    ```
    (No changes)
    ```
    
 **Key Pair**
    ```
    (No changes)
    ```
    
 **Configuration**
    ```
    (No changes)
    ```
    
 **Metadata**
    ```
    (No changes)
    ```

0. Once complete, **click the 'Launch' button**

    > Immediately upon launching the instance (virtual machine), it will begin spawning. How long the instance takes to spawn is completely dependent on how many resources the instance has been created with, and how the the underlying OpenStack architecture has been designed. Thankfully, the Alta3 Research datacenter is strapped with killer hardware, so it shouldn't take too long at all :p
    
    ![spawning instance](https://i.imgur.com/BDAjHqN.png)

0. Once the instance changes from 'Spawning' to 'Running', **sign out of the aliceanderson account**

0. **Log in as** `default:bobbarker:fa5tpa55w0rd`

0. Click on **Project > Compute > Overview**

    > You should see the same total available resources that the account aliceanderson saw. Remember, both Alice and Bob are part of the same project (acme_inc)

0. **Click on Project > Compute > Instances**

    > You should still see the same instance that the account aliceanderson saw. Again, both Alice and Bob are part of the same project (acme_inc)

0. Logged in as bobbarker, **click on the 'Launch Instance' button**, then create the following instance:

 **Details Tab**
    ```
    Instance Name: acme_vm2
    Availability Zone: nova
    Count: 1
    ```
    
 **Source**
    ```
    Select Boot Source: Image (from drop down menu)
    Create New Volume: No
    Allocated: cirros (selected by pressing the + button)
    ```
    
 **Flavor**
    ```
    Allocated: m1.tiny (selected by pressing the + button)
    ```
    
 **Networks**
    ```
    Allocated: fabric
    ```
    
 **Network Ports**
    ```
    (No changes)
    ```
    
 **Security Groups**
    ```
    (No changes)
    ```
    
 **Key Pair**
    ```
    (No changes)
    ```
    
 **Configuration**
    ```
    (No changes)
    ```
    
 **Metadata**
    ```
    (No changes)
    ```
    
0. Once complete, **click the 'Launch' button**, and wait for the acme_vm2 instance to finish spawning (this should only take seconds).


0. Once acme_vm2 is running, **click on Project > Compute > Overview**

    > Spend a few minutes checking out this screen. Notice that no more instances or VCPUs are available for this project. It should look similar to the screen shot below:

    ![maxed out](https://i.imgur.com/tO6uT7s.png)

##### 5. Taking control with admin

0. Log out of bobbarker, and log back in as admin.

0. **Navigate to Admin > System > Instances > Instance Name: acme_vm2 > Log Tab**

0. Study the log file and answer the following questions:

    - **Q1: What is the default username associated with this cirrOS image?**
      - A1: cirros
    - **Q2: What is the password associated with this user?**
      - A2: cubswin:)
    
0. **Click on Admin > System > Instances**

0. Check all the tick boxes beside the running instances. **Click  'Delete Instances'**. All instances should begin shutting down.

0. Once more log out of admin, and log back in as aliceanderson or bobbarker.

    > The acme_inc project should once again have no instances running. Check the Project > Compute > Overview dashboard and the Project > Compute > Instances dashboard to be sure. 
 
    > Deleting an instance will kill the instance (forever)  

    > In this case, the *admin* user deleted a machine created by *bobbarker*. You may be wondering why bobbarker did not delete the machine that he created, and indeed that is normally how it is done. In this case, we just wanted to show you thad admin has access to manipulate VMs across projects (tenant) spaces.

##### 6. Misc

0. Session timeout setting
    > If the 2 minute timeout is annoyingly short, you can change the Openstack timeout following this suggestion: https://ask.openstack.org/en/question/32206/horizon-session-timeout/

    > **SESSION_TIMEOUT**- This SESSION_TIMEOUT is a method to supercede the token timeout with a shorter horizon session timeout (in seconds). So if your token expires in 60 minutes, a value of 1800 will log users out after 30 minutes.
